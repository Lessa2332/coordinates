<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>üåç –ü–ª–∞–Ω–µ—Ç–∞ üìç</title>

    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>

    <style>
        html, body { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; background: #000; font-family: 'Comic Neue', 'Comic Sans MS', cursive, sans-serif; }
        
        .arjs-loader {
            height: 100%; width: 100%; position: absolute; top: 0; left: 0;
            background: rgba(135, 206, 235, 0.9); z-index: 9999;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            color: #FF4500; font-size: 1.5em; text-align: center; padding: 20px; box-sizing: border-box;
        }

        .controls {
            position: absolute; bottom: 25px; left: 50%; transform: translateX(-50%);
            z-index: 10000; display: flex; gap: 10px; width: 95%; justify-content: center;
        }

        .btn {
            padding: 12px 20px; border: none; border-radius: 20px;
            cursor: pointer; font-size: 1em; font-weight: bold;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3); text-decoration: none;
            color: white; font-family: inherit;
        }
        .sound-btn { background-color: #4CAF50; }
        .sound-btn.off { background-color: #f44336; }
        .youtube-btn { background-color: #FF9800; }

        .status-panel {
            position: absolute; top: 20px; left: 50%; transform: translateX(-50%);
            width: 80%; background: rgba(255, 255, 255, 0.8);
            padding: 10px; border-radius: 15px; text-align: center;
            z-index: 10000; font-size: 0.9em; color: #333; box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
    </style>
</head>
<body style="margin: 0; overflow: hidden;">

    <div class="arjs-loader" id="loader">
        <div>üåç –°–≤—ñ—Ç –ø–æ—Ä—É—á! üéà</div>
        <div style="margin-top: 15px; font-size: 0.7em;">–®—É–∫–∞—î–º–æ —Ç–æ—á–∫—É –±—ñ–ª—è –ó–û–® ‚Ññ6...<br>–î–æ–∑–≤–æ–ª—å –¥–æ—Å—Ç—É–ø –¥–æ GPS —Ç–∞ –∫–∞–º–µ—Ä–∏.</div>
    </div>

    <div class="status-panel" id="status-panel">
        <span id="distance-text">–û—á—ñ–∫—É—î–º–æ GPS –¥–∞–Ω—ñ...</span>
    </div>

    <a-scene
        vr-mode-ui="enabled: false"
        embedded
        arjs="sourceType: webcam; debugUIEnabled: false;"
        renderer="logarithmicDepthBuffer: true; colorManagement: true;"
    >
        <a-assets>
            <img id="earth-texture" src="./earth.jpg" crossorigin="anonymous">
            <audio id="bg-music" src="./bg-music.mp3" preload="auto" loop></audio>
        </a-assets>

        <a-entity 
            id="planet-container"
            gps-entity-place="latitude: 46.297082; longitude: 30.650495;"
            position="0 1.2 0"
            scale="12 12 12"
        >
            <a-sphere
                id="hand-planet"
                radius="1"
                src="#earth-texture"
                material="side: double"
                animation="property: rotation; to: 0 360 0; loop: true; dur: 25000; easing: linear"
            ></a-sphere>

            <a-sphere radius="1.08" material="color: #87CEFA; transparent: true; opacity: 0.15; side: double"></a-sphere>
        </a-entity>

        <a-camera gps-camera="minDistance: 1; maxDistance: 100;" rotation-reader></a-camera>
    </a-scene>

    <div class="controls">
        <button id="sound-btn" class="btn sound-btn">–£–≤—ñ–º–∫–Ω—É—Ç–∏ –∑–≤—É–∫</button>
        <a href="https://www.youtube.com/playlist?list=PL6UDFwT9TzFw5K8Tzu_OgsDz7vV3N9eY-" target="_blank" class="btn youtube-btn">YouTube</a>
    </div>

    <script>
        const bgMusic = document.getElementById('bg-music');
        const soundBtn = document.getElementById('sound-btn');
        const loader = document.getElementById('loader');
        const distText = document.getElementById('distance-text');
        const planetContainer = document.getElementById('planet-container');
        const planetSphere = document.getElementById('hand-planet');

        window.addEventListener('arjs-video-loaded', () => {
            loader.style.display = 'none';
        });

        soundBtn.addEventListener('click', () => {
            if (bgMusic.paused) {
                bgMusic.play().catch(e => console.log("Audio Error:", e));
                soundBtn.textContent = '–í–∏–º–∫–Ω—É—Ç–∏ –∑–≤—É–∫';
                soundBtn.classList.remove('off');
            } else {
                bgMusic.pause();
                soundBtn.textContent = '–£–≤—ñ–º–∫–Ω—É—Ç–∏ –∑–≤—É–∫';
                soundBtn.classList.add('off');
            }
        });

        window.addEventListener('gps-entity-place-update-positon', (e) => {
            const distance = e.detail.distance;
            if (distance > 1000) {
                distText.innerText = `–î–æ –æ–±'—î–∫—Ç–∞: ${(distance/1000).toFixed(2)} –∫–º`;
            } else {
                distText.innerText = `–ü–ª–∞–Ω–µ—Ç–∞ –ø–µ—Ä–µ–¥ —Ç–æ–±–æ—é! –í—ñ–¥—Å—Ç–∞–Ω—å: ${Math.round(distance)} –º`;
            }
        });

        // –Ü–ù–¢–ï–†–ê–ö–¢–ò–í (–ö–†–£–¢–Ü–ù–ù–Ø –¢–ê –ó–£–ú)
        let lastDist = 0;
        let startX = 0;

        document.addEventListener('touchstart', (e) => {
            if (e.touches.length === 1) {
                startX = e.touches[0].pageX;
            } else if (e.touches.length === 2) {
                const dx = e.touches[0].pageX - e.touches[1].pageX;
                const dy = e.touches[0].pageY - e.touches[1].pageY;
                lastDist = Math.sqrt(dx * dx + dy * dy);
            }
        });

        document.addEventListener('touchmove', (e) => {
            if (e.touches.length === 1 && planetSphere) {
                const deltaX = e.touches[0].pageX - startX;
                planetSphere.object3D.rotation.y += deltaX * 0.01;
                startX = e.touches[0].pageX;
            }
            
            if (e.touches.length === 2 && planetContainer) {
                const dx = e.touches[0].pageX - e.touches[1].pageX;
                const dy = e.touches[0].pageY - e.touches[1].pageY;
                const dist = Math.sqrt(dx * dx + dy * dy);
                const factor = dist / lastDist;
                let currentScale = planetContainer.getAttribute('scale');
                let newS = Math.max(2, Math.min(60, currentScale.x * factor));
                planetContainer.setAttribute('scale', `${newS} ${newS} ${newS}`);
                lastDist = dist;
            }
        });
    </script>
</body>
</html>

